<PageManager>:
    StartScreen:
    MainScreen:

<StartScreen>:
    name: 'start'

    MDScreen:
        md_bg_color: app.theme_cls.surfaceColor

        MDCircularProgressIndicator:
            active: False
            id: progressindicator
            size_hint: None, None
            size: dp(48), dp(48)
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            
        BoxLayout:
            orientation: 'vertical'

            MDTopAppBar:
                type: "small"
                pos_hint: {"top": 1}

                MDTopAppBarTitle:
                    text: "High-end Control Moduleと接続"

                MDTopAppBarTrailingButtonContainer:
                    MDActionTopAppBarButton:
                        icon: "theme-light-dark"
                        on_release: app.switch_theme_style()

            MDNavigationLayout:
                MDScreenManager:
                    MDScreen:
                        MDBoxLayout:
                            orientation: "horizontal"
                            adaptive_height: True
                            pos_hint: {'center_x': .5, 'center_y': .5}
                            size_hint_x: .3
                            spacing: '10dp'
            
                            MDTextField:
                                mode: "outlined"
                                id: address_field
                                MDTextFieldHintText:
                                    text: "アドレス"

                            MDButton:
                                style: "filled"
                                id: connect_button
                                on_release: root.on_connect_button_press()
                                pos_hint: {"center_y": .5}
                                MDButtonText:
                                    id: connect_button_text
                                    text: "接続"


<MainScreen>:
    name: 'main'

    MDScreen:
        md_bg_color: app.theme_cls.surfaceColor

        BoxLayout:
            orientation: 'vertical'

            MDTopAppBar:
                type: "small"
                pos_hint: {"top": 1}

                MDTopAppBarLeadingButtonContainer:

                    MDActionTopAppBarButton:
                        icon: "menu"
                        on_release: nav_drawer.set_state("toggle")

                MDTopAppBarTitle:
                    text: "Native GUI App"

                MDTopAppBarTrailingButtonContainer:

                    MDActionTopAppBarButton:
                        icon: "theme-light-dark"
                        on_release: app.switch_theme_style()

                    MDButton:
                        style: "elevated"
                        id: disconnect_button
                        on_release: root.on_disconnect_button_press()
                        pos_hint: {"center_y": .5}
                        MDButtonText:
                            text: "切断"

            MDNavigationLayout:

                MDNavigationDrawer:
                    drawer_type: "standard"
                    id: nav_drawer
                    radius: 0, dp(16), dp(16), 0
                    MDNavigationDrawerMenu:
                        id: nav_drawer_menu
                        MDNavigationDrawerLabel:
                            text: "ActuaterList"





                MDScreenManager:
                    MDScreen:
                        radius: [25, 0, 0, 0]
                        BoxLayout:
                            orientation: "vertical"
                            padding: "20dp"
                            spacing: "20dp"
                            
                            BoxLayout:
                                orientation: "horizontal"
                                spacing: "10dp"
                                NonInteractiveCard:
                                    id : graph_area
                                    style: "outlined"
                                    padding: "20dp"
                                    size_hint_x: 2
                                    
                                NonInteractiveCard:
                                    style: "outlined"
                                    BoxLayout:
                                        orientation: "vertical"
                                        padding: [20, 20, 20, 20]  # 左, 上, 右, 下の順にパディングを設定
                                        spacing: 20  # 子ウィジェット間のスペーシングを設定
                                        BoxLayout:
                                            orientation: "horizontal"
                                            MDLabel:
                                                text:"Gain"
                                            MDIconButton:
                                                id: gain_reload
                                                disabled : "True"
                                                pos_hint: {"right":1}
                                                on_release: app.gain_request()
                                                icon: "reload"
                                                style: "standard"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDTextField:
                                                mode: "filled"
                                                id: gain_p
                                                disabled : "True"
                                                input_filter: "float"
                                                MDTextFieldHintText:
                                                    text: "p"
                                            MDButton:
                                                style: "elevated"
                                                id: p_send
                                                disabled : "True"
                                                pos_hint: {'center_y': 0.5}
                                                on_release: app.gain_change('p')
                                                MDButtonText:
                                                    text: "変更"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDTextField:
                                                mode: "filled"
                                                id: gain_i
                                                disabled : "True"
                                                input_filter: "float"
                                                MDTextFieldHintText:
                                                    text: "i"
                                            MDButton:
                                                style: "elevated"
                                                id: i_send
                                                disabled : "True"
                                                pos_hint: {'center_y': 0.5}
                                                on_release: app.gain_change('i')
                                                MDButtonText:
                                                    text: "変更"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDTextField:
                                                mode: "filled"
                                                id: gain_d
                                                disabled : "True"
                                                input_filter: "float"
                                                MDTextFieldHintText:
                                                    text: "d"
                                            MDButton:
                                                style: "elevated"
                                                id: d_send
                                                disabled : "True"
                                                pos_hint: {'center_y': 0.5}
                                                on_release: app.gain_change('d')
                                                MDButtonText:
                                                    text: "変更"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            MDLabel:
                                                text:"Gain書込"
                                            MDButton:
                                                style: "filled"
                                                id: gain_save
                                                disabled : "True"
                                                pos_hint: {"right":1}
                                                on_release: app.gain_save()
                                                MDButtonText:
                                                    text: "保存"
                            
                            BoxLayout:
                                orientation: "horizontal"
                                spacing: "20dp"
                                size_hint_y: 0.7
                                NonInteractiveCard:
                                    style: "outlined"
                                    padding: "20dp"
                                    size_hint_x: .3
                                    BoxLayout:
                                        orientation: "vertical"
                                        padding: [20, 20, 20, 20]  # 左, 上, 右, 下の順にパディングを設定
                                        spacing: 20  # 子ウィジェット間のスペーシングを設定
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: position_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "blue"
                                                active: True
                                            MDLabel:
                                                text:"Position"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: voltage_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "orange"
                                                active: True
                                            MDLabel:
                                                text:"Voltage"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: command_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "green"
                                                active: True
                                            MDLabel:
                                                text:"Command"

                                NonInteractiveCard:
                                    style: "outlined"
                                    padding: "20dp"
                                    BoxLayout:
                                        orientation: "vertical"
                                        MDLabel:
                                            text:"Target->Position"
                                        MDSlider:
                                            id: position_slider
                                            disabled : "True"
                                            min: 0
                                            max: 4095
                                            value: 2000
                                            on_value: app.slider_position = str(int(self.value))
                                            MDSliderHandle:
                                            MDSliderValueLabel:
                                        MDLabel:
                                            text:"Target->Command"
                                        MDSlider:
                                            id: command_slider
                                            disabled : "True"
                                            min: 0
                                            max: 4095
                                            value: 2000
                                            on_value: app.slider_command = str(int(self.value))
                                            MDSliderHandle:
                                            MDSliderValueLabel:
                                        MDButton:
                                            style: "filled"
                                            id: capture
                                            disabled : "True"
                                            pos_hint: {"right":1}
                                            on_release: app.req_capture()
                                            MDButtonText:
                                                text: "キャプチャ"