<PageManager>:
    StartScreen:
    MainScreen:

<StartScreen>:
    name: 'start'

    MDScreen:
        md_bg_color: app.theme_cls.surfaceColor

        MDCircularProgressIndicator:
            active: False
            id: progressindicator
            size_hint: None, None
            size: dp(48), dp(48)
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            
        BoxLayout:
            orientation: 'vertical'

            MDTopAppBar:
                type: "small"
                pos_hint: {"top": 1}

                MDTopAppBarTitle:
                    text: "High-end Control Moduleと接続"

                MDTopAppBarTrailingButtonContainer:
                    MDActionTopAppBarButton:
                        icon: "theme-light-dark"
                        on_release: app.switch_theme_style()

            MDNavigationLayout:
                MDScreenManager:
                    MDScreen:
                        MDBoxLayout:
                            orientation: "horizontal"
                            adaptive_height: True
                            pos_hint: {'center_x': .5, 'center_y': .5}
                            size_hint_x: .3
                            spacing: '10dp'
            
                            MDTextField:
                                mode: "outlined"
                                id: address_field
                                MDTextFieldHintText:
                                    text: "Address"

                            CustomMDButton:
                                style: "filled"
                                id: connect_button
                                on_release: root.on_connect_button_press()
                                pos_hint: {"center_y": .5}
                                MDButtonText:
                                    id: connect_button_text
                                    text: "Connect"


<MainScreen>:
    name: 'main'

    MDScreen:
        md_bg_color: app.theme_cls.surfaceColor

        BoxLayout:
            orientation: 'vertical'

            MDTopAppBar:
                type: "small"
                pos_hint: {"top": 1}

                MDTopAppBarLeadingButtonContainer:

                    MDActionTopAppBarButton:
                        icon: "menu"
                        on_release: nav_drawer.set_state("toggle")

                MDTopAppBarTitle:
                    text: "Native GUI App"

                MDTopAppBarTrailingButtonContainer:

                    MDActionTopAppBarButton:
                        icon: "theme-light-dark"
                        on_release: app.switch_theme_style()

                    CustomMDButton:
                        style: "elevated"
                        id: disconnect_button
                        on_release: root.on_disconnect_button_press()
                        pos_hint: {"center_y": .5}
                        MDButtonText:
                            text: "Disconnect"

            MDNavigationLayout:

                MDNavigationDrawer:
                    drawer_type: "standard"
                    id: nav_drawer
                    radius: 0, dp(16), dp(16), 0
                    BoxLayout:
                        orientation:'vertical'
                        MDNavigationDrawerMenu:
                            id: nav_drawer_menu
                            MDNavigationDrawerLabel:
                                text: "ActuaterList"
                        MDNavigationDrawerDivider:
                        BoxLayout:
                            orientation:'vertical'
                            size_hint_y: 0.3
                            MDNavigationDrawerLabel:
                                text:"Fixed motion"                                
                            GridLayout:
                                spacing: '10dp'
                                size_hint_x: 1
                                pos_hint: {'center_x': .5, 'center_y': .5}
                                cols:2
                                rows:2
                                CustomMDButton:
                                    style: "outlined"
                                    theme_width: "Custom"
                                    size_hint_x: 1
                                    on_release: app.fixed_motion('crawl')
                                    MDButtonIcon:
                                        icon:"turtle"
                                    MDButtonText:
                                        text: "Crawl"
                                CustomMDButton:
                                    style: "outlined"
                                    theme_width: "Custom"
                                    size_hint_x: 1
                                    on_release: app.fixed_motion('trot')
                                    MDButtonIcon:
                                        icon:"horse"
                                    MDButtonText:
                                        text: "Trot"
                                CustomMDButton:
                                    style: "outlined"
                                    theme_width: "Custom"
                                    size_hint_x: 1
                                    on_release: app.fixed_motion('pace')
                                    MDButtonIcon:
                                        icon:"elephant"
                                    MDButtonText:
                                        text: "Pace"
                                CustomMDButton:
                                    style: "outlined"
                                    theme_width: "Custom"
                                    size_hint_x: 1
                                    on_release: app.fixed_motion('bound')
                                    MDButtonIcon:
                                        icon:"rabbit"
                                    MDButtonText:
                                        text: "Bound"






                MDScreenManager:
                    MDScreen:
                        radius: [25, 0, 0, 0]
                        BoxLayout:
                            orientation: "vertical"
                            padding: "20dp"
                            spacing: "20dp"
                            
                            BoxLayout:
                                orientation: "horizontal"
                                spacing: "10dp"
                                NonInteractiveCard:
                                    id : graph_area
                                    style: "outlined"
                                    padding: "20dp"
                                    size_hint_x: 2
                                    
                                NonInteractiveCard:
                                    style: "outlined"
                                    BoxLayout:
                                        orientation: "vertical"
                                        padding: [20, 20, 20, 20]  # 左, 上, 右, 下の順にパディングを設定
                                        spacing: 20  # 子ウィジェット間のスペーシングを設定
                                        BoxLayout:
                                            orientation: "horizontal"
                                            pos_hint: {"top":1}
                                            MDLabel:
                                                text:"Change Gain"
                                            MDIconButton:
                                                id: gain_reload
                                                disabled : "True"
                                                pos_hint: {"right":1}
                                                on_release: app.gain_request()
                                                icon: "reload"
                                                style: "standard"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            BoxLayout:
                                                orientation: "vertical"
                                                spacing: 20
                                                MDTextField:
                                                    mode: "filled"
                                                    id: gain_p
                                                    disabled : "True"
                                                    input_filter: "float"
                                                    MDTextFieldHintText:
                                                        text: "p"
                                                MDTextField:
                                                    mode: "filled"
                                                    id: gain_i
                                                    disabled : "True"
                                                    input_filter: "float"
                                                    MDTextFieldHintText:
                                                        text: "i"
                                                MDTextField:
                                                    mode: "filled"
                                                    id: gain_d
                                                    disabled : "True"
                                                    input_filter: "float"
                                                    MDTextFieldHintText:
                                                        text: "d"
                                            CustomMDButton:
                                                style: "elevated"
                                                id: gain_send
                                                disabled : "True"
                                                pos_hint: {'center_y': 0.5}
                                                on_release: app.gain_change()
                                                MDButtonText:
                                                    text: "Upload"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            MDLabel:
                                                text:"Save Gain"
                                            CustomMDButton:
                                                style: "filled"
                                                id: gain_save
                                                disabled : "True"
                                                pos_hint: {"right":1}
                                                on_release: app.gain_save()
                                                MDButtonText:
                                                    text: "Save"
                            
                            BoxLayout:
                                orientation: "horizontal"
                                spacing: "20dp"
                                size_hint_y: 0.7
                                NonInteractiveCard:
                                    style: "outlined"
                                    padding: "20dp"
                                    size_hint_x: .3
                                    BoxLayout:
                                        orientation: "vertical"
                                        padding: [20, 20, 20, 20]  # 左, 上, 右, 下の順にパディングを設定
                                        spacing: 20  # 子ウィジェット間のスペーシングを設定
                                        MDLabel:
                                            pos_hint: {'top': 1}
                                            text:"Drawing switch"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: position_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "blue"
                                                active: True
                                            MDLabel:
                                                text:"Position"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: voltage_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "orange"
                                                active: True
                                            MDLabel:
                                                text:"Voltage"
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDSwitch:
                                                id: command_switch
                                                pos_hint: {'center_y': 0.5}
                                                track_color_active: "green"
                                                active: True
                                            MDLabel:
                                                text:"Command"

                                NonInteractiveCard:
                                    style: "outlined"
                                    padding: "20dp"
                                    BoxLayout:
                                        orientation: "vertical"
                                        MDLabel:
                                            text:"Target->Position"
                                        MDSlider:
                                            id: position_slider
                                            disabled : "True"
                                            min: 0
                                            max: 4095
                                            value: 2000
                                            on_value: app.slider_position = str(int(self.value))
                                            MDSliderHandle:
                                            MDSliderValueLabel:
                                        MDLabel:
                                            text:"Target->Command"
                                        MDSlider:
                                            id: command_slider
                                            disabled : "True"
                                            min: 0
                                            max: 4095
                                            value: 2000
                                            on_value: app.slider_command = str(int(self.value))
                                            MDSliderHandle:
                                            MDSliderValueLabel:
                                        BoxLayout:
                                            orientation: "horizontal"
                                            spacing: 20
                                            MDLabel:
                                                text:"Capture"
                                            CustomMDButton:
                                                style: "filled"
                                                id: offset_capture
                                                disabled : "True"
                                                
                                                on_release: app.req_capture("offset")
                                                MDButtonText:
                                                    text: "Offset"
                                            CustomMDButton:
                                                style: "filled"
                                                id: stroke_capture
                                                disabled : "True"
                                                
                                                on_release: app.req_capture("stroke")
                                                MDButtonText:
                                                    text: "Stroke"